import sysimport osimport pandas as pdfrom optimization.feature_extraction import prepare_data, setup_deap, run_ga, save_selected_data# Parametersdata_path = "train_data.csv"target_column = "Class"sample_frac = 0.2  # Adjust the fraction of data to use for trainingpopulation_size = 10generations = 2# Load the original dataoriginal_data = pd.read_csv(data_path)# Sample the datasampled_data = original_data.sample(frac=sample_frac, random_state=42)# Prepare the dataX, y = prepare_data(sampled_data, target_column)# Setup DEAPtoolbox = setup_deap(X)# Run the genetic algorithm to select featuresselected_columns = run_ga(toolbox, X, y, sampled_data.columns, population_size=population_size, generations=generations)# Save the data with selected features applied to the original datasave_selected_data(original_data, selected_columns, target_column, output_path="train_data_selected1.csv")